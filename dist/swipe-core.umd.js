!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n["swipe-core"]=t()}(this,function(){"use strict";var U=!!function(n){var t=!1;function e(){}var i=Object.defineProperty({},"passive",{get:function(){t=!0}});return window.addEventListener("testPassive",e,i),window.removeEventListener("testPassive",e,i),t}()&&{capture:!1,passive:!0},Z=function(n,t,e,i){void 0===i&&(i=U),n.removeEventListener(t,e,i)},_=function(n){return"function"==typeof n},nn=function(n){var t=n.getBoundingClientRect();return t.top<window.innerHeight&&0<t.bottom&&t.left<window.innerWidth&&0<t.right},tn={cubic:function(n){return--n*n*n+1},circ:function(n){return Math.sqrt(1-Math.pow(n-1,2))}},en=function(n,t){return window.getComputedStyle(n,null).getPropertyValue(t)};function rn(){this.value=0}rn.prototype={is:function(n){return this.value&n},or:function(n){return this.value=this.value|n,this},rm:function(n){return this.value=this.value&~n,this},set:function(n){return this.value=n,this}};var on={root:null,rootMargin:"0px",threshold:[0,.01]},un=!!window.IntersectionObserver;function an(n){var t=this;n.forEach(function(n){return t.append(n)})}an.prototype.append=function(n){var t=n.$next=n.$prev=n;return this.$tail?(t.$prev=this.$tail,t.$next=this.$tail.$next,(this.$tail.$next=t).$next.$prev=t,this.$tail=t):this.$head=this.$tail=t};var n=["webkit","moz","ms","o"],cn=n.reduce(function(n,t){return n||window[t+"RequestAnimationFrame"]},window.requestAnimationFrame).bind(window),sn=n.reduce(function(n,t){return n||window[t+"CancelAnimationFrame"]},window.cancelAnimationFrame).bind(window);if(!cn||!sn){var e=0;cn=function(n){var t=+new Date;return e=Math.max(t,e+16),setTimeout(n,e-t)},sn=clearTimeout}function fn(){var e=Object.create(null),r=function(n){return e[n]||(e[n]=[]),e[n]},i=function(n,t){t?r(n).splice(r(n).indexOf(t),1):delete e[n]};return{on:function(n,t){return r(n).push(t),function(){return i(n,t)}},off:i,trigger:function(n){for(var t=arguments,e=[],i=arguments.length-1;0<i--;)e[i]=t[i+1];r(n).forEach(function(n){return n.apply(null,e)})},$get:r,$destroy:function(){Object.keys(e).forEach(function(n){i(n)})}}}var ln=120,dn=250,hn=1e3,vn=2*hn/3,pn=3e3,wn={auto:!1,cycle:!0,expose:!1,root:null,elms:[],index:0,width:window.screen.width,height:200,css:!1,ease:"cubic",plugins:[]};return function(n){var o=Object.create(new fn),t=document.createElement("div");t.style.display="none",document.body.appendChild(t);var u=Object.assign({},wn,n),a=u.index,c=u.root,s=u.elms,f=u.width,l=u.height,d=u.cycle,h=(u.expose,u.auto),v=u.css,p=u.ease;if(u.plugins.forEach(function(t){return Object.keys(t).forEach(function(n){return o.on(n,t[n])})}),c){v&&(f=Number(en(c,"width").slice(0,-2)),l=Number(en(c,"height").slice(0,-2)));var w=c.children[0],m={main:-1,auto:-1},x=f/3,$={idle:0,start:1,drag:2,animate:4,scroll:8,auto:16,cancel:32},g=new rn,e=0,b=0,r=0,y=0,E=0,i=0,M=0,O=0,j=[],C=!1;h=d&&h;var k=s[a],D=function(n){return o.trigger(n,k.$index,k,w,s)},N=function(n,t){var e,i;i=n.x=t,(e=n)&&(e.style.transition=e.style.webkitTransition="",e.style.transform=e.style.webkitTransform="translate3d("+i+"px, 0, 0)",D("move"))},T=function(n){return t.appendChild(n)},A=function(n){return w.appendChild(n)},F=function(n){return!d&&i<M&&k===j.$head},L=function(n){return!d&&M<=i&&k===j.$tail},P=function(n){return clearTimeout(m.auto)},q=function(n){return P(g.set($.cancel))},R=function(n){P(),sn(m.main)},X=!0,z=[],H=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return z.push(function(n,t,e,i){return void 0===i&&(i=U),n.addEventListener(t,e,i),function(){return Z(n,t,e,i)}}.apply(null,n))};return function(){if(0===s.length)return o.trigger("init",-1);c.style.position="relative",v||(c.style.width=f+"px",c.style.height=l+"px");var n=2===s.length&&d;n&&(s.push(s[0].cloneNode(!0)),A(s[2]),s.push(s[1].cloneNode(!0)),A(s[3]),s[0].$index=s[2].$index=0,s[1].$index=s[3].$index=1);var t=1===s.length;if(C=2===s.length,j=new an(s),n||s.forEach(function(n,t){return n.$index=t}),N(k,0),t||C||N(k.$prev,-f),t||N(k.$next,f),s.forEach(function(n){n.style.position="absolute",v||(n.style.width=f+"px",n.style.height=l+"px"),C||t||n===k||n===k.$prev||n===k.$next||T(n)}),t)return D("init");if(C||d||0!==a||T(k.$prev),C||d||a!==s.length-1||T(k.$next),H(c,"touchstart",I),H(c,"touchmove",Y),H(c,"touchend",K),h){if(un)cn(function(){u.unobserve=function(n,t){if(!un)return t();var e=new IntersectionObserver(t,on);return e.observe(n),function(){e.unobserve(n)}}(c,function(n){n&&0===n[0].intersectionRatio?q():J()})});else{var e=function(){return nn(c)?W():q()};H(window,"touchmove",function(){return nn(c)||q()}),H(window,"touchend",e),e()}var i=["webkit","moz","ms","-"].reduce(function(n,t){return void 0!==document[n[0]]?n:[t+"Hidden",t+"visibilitychange"]},["hidden","visibilitychange"]),r=i[0];i[1],"-"!==r[0]&&H(document,"visibilitychange",function(){document[r]?q():W()},!1)}w.x=0,D("init")}(),o.destroy=function(){R(),_(u.unobserve)&&u.unobserve(),z.forEach(function(n){return n()}),t.parentNode&&t.parentNode.removeChild(t),o.$destroy()},o.index=function(){return k.$index},o.stop=function(){X=!1},o.start=function(){X=!0},o}function I(n){if(X){R(),g.or($.start).rm($.scroll),r=0;var t=n.touches[0];E=Date.now(),b=M=i=t.pageX,O=t.clientY,D("start")}}function Y(n){if(X&&!g.is($.scroll)){var t=n.touches[0],e=t.pageX-M;if(g.is($.start)&&2*Math.abs(e)<Math.abs(t.clientY-O))g.or($.scroll).rm($.start);else{var i=0<e?1:-1;r!==i&&(b=M,E=Date.now(),r=i),g.set($.drag),M=t.pageX,N(w,y+=e)}}}function B(){C||T(k.$next),k=k.$prev,F()||(N(k.$prev,k.x-f),A(k.$prev))}function S(){C||T(k.$prev),k=k.$next,L()||(N(k.$next,k.x+f),A(k.$next))}function V(){0===e&&-k.x-y>f/2&&(e=1,S())}function W(){P(),m.auto=setTimeout(function(){X&&G()},pn)}function G(){e=0,g.set($.auto),D("start"),Q(w,y,-k.x-f,vn,V,W)}function J(){3<Math.abs(y+k.x)?G():W()}function K(n){if(X){if(g.is($.scroll)&&!g.is($.animate)&&!g.is($.auto))return h&&J();g.set($.animate);var t=b<M,e=Date.now()-E<ln;if(!F()&&!L()){var i=k.x+y;e?t&&0<i?B():!t&&i<0&&S():x<i?B():i<-x&&S()}var r=-1*k.x,o=Math.min(Math.max(hn*Math.abs(r-y)/f,dn),vn);Q(w,y,r,e?dn:o,null,h?function(){return J()}:null)}}function Q(i,r,o,u,a,c){var s=Date.now();!function n(){var t=Date.now()-s;if(u<=t&&(y=o),_(a)&&a(),u<=t)return N(i,o),!g.is($.cancel)&&_(c)&&c(),g.set($.idle),D("end");var e=(o-r)*tn[p](t/u)+r;N(i,y=e),m.main=cn(n)}()}}});